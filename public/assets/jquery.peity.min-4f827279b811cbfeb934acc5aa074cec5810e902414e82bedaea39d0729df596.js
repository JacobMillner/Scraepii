!function(t,e,i,n){var s=t.fn.peity=function(e,i){return l&&this.each(function(){var n=t(this),r=n.data("_peity");r?(e&&(r.type=e),t.extend(r.opts,i)):(r=new o(n,e,t.extend({},s.defaults[e],n.data("peity"),i)),n.change(function(){r.draw()}).data("_peity",r)),r.draw()}),this},o=function(t,e,i){this.$el=t,this.type=e,this.opts=i},r=o.prototype,a=r.svgElement=function(i,n){return t(e.createElementNS("http://www.w3.org/2000/svg",i)).attr(n)},l="createElementNS"in e&&a("svg",{})[0].createSVGRect;r.draw=function(){var t=this.opts;s.graphers[this.type].call(this,t),t.after&&t.after.call(this,t)},r.fill=function(){var e=this.opts.fill;return t.isFunction(e)?e:function(t,i){return e[i%e.length]}},r.prepare=function(t,e){return this.$svg||this.$el.hide().after(this.$svg=a("svg",{"class":"peity"})),this.$svg.empty().data("peity",this).attr({height:e,width:t})},r.values=function(){return t.map(this.$el.text().split(this.opts.delimiter),function(t){return parseFloat(t)})},s.defaults={},s.graphers={},s.register=function(t,e,i){this.defaults[t]=e,this.graphers[t]=i},s.register("pie",{fill:["#ff9900","#fff4dd","#ffc66e"],radius:8},function(e){if(!e.delimiter){var n=this.$el.text().match(/[^0-9\.]/);e.delimiter=n?n[0]:","}if(n=t.map(this.values(),function(t){return t>0?t:0}),"/"==e.delimiter)var s=n[0],n=[s,i.max(0,n[1]-s)];for(var o=0,s=n.length,r=0;s>o;o++)r+=n[o];r||(s=2,r=1,n=[0,1]);var l=2*e.radius,l=this.prepare(e.width||l,e.height||l),o=l.width(),h=l.height(),c=o/2,u=h/2,h=i.min(c,u),e=e.innerRadius;"donut"==this.type&&!e&&(e=.5*h);for(var d=i.PI,p=this.fill(),f=this.scale=function(t,e){var n=t/r*d*2-d/2;return[e*i.cos(n)+c,e*i.sin(n)+u]},g=0,o=0;s>o;o++){var m=n[o],v=m/r;if(0!=v){if(1==v)if(e)var v=c-.01,y=u-h,b=u-e,v=a("path",{d:["M",c,y,"A",h,h,0,1,1,v,y,"L",v,b,"A",e,e,0,1,0,c,b].join(" ")});else v=a("circle",{cx:c,cy:u,r:h});else y=g+m,b=["M"].concat(f(g,h),"A",h,h,0,v>.5?1:0,1,f(y,h),"L"),e?b=b.concat(f(y,e),"A",e,e,0,v>.5?1:0,0,f(g,e)):b.push(c,u),g+=m,v=a("path",{d:b.join(" ")});v.attr("fill",p.call(this,m,o,n)),l.append(v)}}}),s.register("donut",t.extend(!0,{},s.defaults.pie),function(t){s.graphers.pie.call(this,t)}),s.register("line",{delimiter:",",fill:"#c6d9fd",height:16,min:0,stroke:"#4d89f9",strokeWidth:1,width:32},function(t){var e=this.values();1==e.length&&e.push(e[0]);for(var s=i.max.apply(i,t.max==n?e:e.concat(t.max)),o=i.min.apply(i,t.min==n?e:e.concat(t.min)),r=this.prepare(t.width,t.height),l=t.strokeWidth,h=r.width(),c=r.height()-l,u=s-o,s=this.x=function(t){return t*(h/(e.length-1))},d=this.y=function(t){var e=c;return u&&(e-=(t-o)/u*c),e+l/2},p=d(i.max(o,0)),f=[0,p],g=0;g<e.length;g++)f.push(s(g),d(e[g]));f.push(h,p),t.fill&&r.append(a("polygon",{fill:t.fill,points:f.join(" ")})),l&&r.append(a("polyline",{fill:"none",points:f.slice(2,f.length-2).join(" "),stroke:t.stroke,"stroke-width":l,"stroke-linecap":"square"}))}),s.register("bar",{delimiter:",",fill:["#4D89F9"],height:16,min:0,padding:.1,width:32},function(t){for(var e=this.values(),s=i.max.apply(i,t.max==n?e:e.concat(t.max)),o=i.min.apply(i,t.min==n?e:e.concat(t.min)),r=this.prepare(t.width,t.height),l=r.width(),h=r.height(),c=s-o,t=t.padding,u=this.fill(),d=this.x=function(t){return t*l/e.length},p=this.y=function(t){return h-(c?(t-o)/c*h:1)},f=0;f<e.length;f++){var g,m=d(f+t),v=d(f+1-t)-m,y=e[f],b=p(y),x=b;c?0>y?x=p(i.min(s,0)):b=p(i.max(o,0)):g=1,g=b-x,0==g&&(g=1,s>0&&c&&x--),r.append(a("rect",{fill:u.call(this,y,f,e),x:m,y:x,width:v,height:g}))}})}(jQuery,document,Math);